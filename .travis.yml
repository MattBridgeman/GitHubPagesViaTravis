# For more information about the configurations used
# in this file, please see the Travis CI documentation:
# http://docs.travis-ci.com

after_success:
  - |

      declare -r PRIVATE_KEY_FILE_NAME='github_deploy_key'

      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

      # Decrypt the file containing the private key
      # ([!] this is generated by the Travis CLI, see step 2.5)

      openssl aes-256-cbc \
        -K $encrypted_52faaafbc0b8_key \
        -iv $encrypted_52faaafbc0b8_iv \
        -in "${PRIVATE_KEY_FILE_NAME}.enc" \
        -out ~/.ssh/$PRIVATE_KEY_FILE_NAME -d

      # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

      # Enable SSH authentication

      chmod 600 ~/.ssh/$PRIVATE_KEY_FILE_NAME
      echo "Host github.com" >> ~/.ssh/config
      echo "  IdentityFile ~/.ssh/$PRIVATE_KEY_FILE_NAME" >> ~/.ssh/config

      $(npm bin)/update-branch --commands "npm install && npm run build"
                             --commit-message "Hey GitHub, this content is for you! [skip ci]"
                             --directory "build"
                             --distribution-branch "gh-pages"
                             --source-branch "master"

env:
  global:
    - CXX=g++-4.8
    - secure: "jSsVOhgz4STnLmroAhtuPTD+x5T/JTizsTjGkDbyGe3FvSSVu2306zAQUCnLN41+49jk2cnYIMy3GxNvNKnsUT/fA0H9uefHt7+Mo+H18EQl6VZFdN/pxH4puZU5zUJ5YfS/IbFsXP9IBrSDaGYBMO2dpx0hAzPMwX4ZufLXP/4MrsRF5FOwaJ8Ns07m76dej7vaZ7F4XguC1hAd5m83tR0v+HT25QqJDtJf+TuVRpm/YIieBYypE1Bj1E+cY+nwOs5w1daDdTxDlIkgb3E+nf+kipQ9esS+dkd1iGnPr9uQBvlgyWZsfm7FjWZpWZXGH5BKW6w92EmzK7d36n4hIiggmb2qZhBrVMXRJ76Tb7vMgx27nfkHc18pd08QJNm3O8pAOpIpzLk4tXFF1jDA84JivbgndmL0A2oO5fQyDiNutKHwWbb/05kkulLJGlYmJMmuavPM1v1FPAvX3XeAqyChgSuloZxKEws05F4IMkChTD4/lzSnvMqmaNm+BoNskUpruV4e0UvKINnS5y7RKamhFWu+rTCX+vVlcjNpd/rQIF6UQPmJBlwEF24o7AnniYP4SEHvl0d8RJK6PhD/r4L9XVIcnQ6O4wLkRhhIp4F+ktwAkedQ45MeK7gyc/sG0zYSThW4C8N4qJUEg5112h0nJD7CVZYm0axAYDoIyGQ="

git:
  depth: 10

language: node_js

node_js:
  - "4"

script:
  - npm run check:src
  - npm run build

sudo:
  - required

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.8

branches:
  only:
    - master